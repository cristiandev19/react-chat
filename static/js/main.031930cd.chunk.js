(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{32:function(e,t,c){var n={dev:!1,backend:"http://appreact-chat.herokuapp.com/"};e.exports={config:n}},58:function(e,t,c){},59:function(e,t,c){},60:function(e,t,c){},96:function(e,t,c){"use strict";c.r(t);var n=c(0),s=c.n(n),a=c(51),o=c.n(a),r=(c(58),c(8)),i=(c(59),c(60),c(22)),u=c(2),l=c(4),j=(0,c(0).createContext)(),b=c(24),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(n.useState)(e),c=Object(r.a)(t,2),s=c[0],a=c[1],o=function(e){var t=e.target;a(Object(l.a)(Object(l.a)({},s),{},Object(b.a)({},t.name,t.value)))};return[s,o,a]},O={login:"[auth] login",logout:"[auth] logout"},g=c(1),m=function(){var e=Object(u.f)(),t=Object(n.useContext)(j),c=t.user,s=t.dispatch,a=d({userName:""}),o=Object(r.a)(a,2),i=o[0],b=o[1];return console.log("user",c),Object(g.jsxs)("div",{children:[c.logged?Object(g.jsx)("h2",{children:"Bienvenido ".concat(c.userName)}):Object(g.jsx)("h2",{children:"Bienvenido a tu chat"}),Object(g.jsxs)("label",{htmlFor:"userName",children:["Ingresa tu nombre de usuario:",Object(g.jsx)("input",{type:"text",name:"userName",id:"userName",onChange:b})]}),Object(g.jsx)("button",{onClick:function(){var t=i;console.log({userName:t}),s({type:O.login,payload:Object(l.a)({},t)}),e.push("/chat/".concat(123))},type:"button",children:"Ingresar"})]})},h=c(33),f=c(53),v=c.n(f),x=c(32),p=function(){var e=Object(n.useState)([]),t=Object(r.a)(e,2),c=t[0],s=t[1],a=Object(n.useState)(null),o=Object(r.a)(a,2),i=o[0],u=o[1],b=Object(n.useContext)(j).user,O=Object(n.useState)(!1),m=Object(r.a)(O,2),f=m[0],p=m[1],N=d({message:""}),C=Object(r.a)(N,3),y=C[0],S=C[1],k=C[2],I=y.message,E=Object(n.useRef)(null);Object(n.useEffect)((function(){!function(){var e;null===(e=E.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}()}),[c]),Object(n.useEffect)((function(){return console.log("socket",i),console.log("process.env.BACK_DOMAIN",x.config.backend),i||u(v()(x.config.backend)),console.log("socket",i),function(){return i?i.disconnect():null}}),[]),Object(n.useEffect)((function(){if(i){i.on("connect",(function(){p(i.connected)})),console.log("socketConnected",f);i.on("updateChat",(function(e){s((function(t){return[].concat(Object(h.a)(t),[e])}))})),i.on("disconnect",(function(){p(i.connected)}))}}),[i]);return Object(g.jsxs)("div",{className:"chat-container",children:[Object(g.jsxs)("div",{className:"chat-messages",children:[c.map((function(e){return e.userName===b.userName?Object(g.jsxs)("div",{className:"message my-message",children:[Object(g.jsx)("div",{className:"message-content",children:e.message}),Object(g.jsx)("div",{className:"message-user",children:e.userName})]},e.time):Object(g.jsxs)("div",{className:"message other-message",children:[Object(g.jsx)("div",{className:"message-content",children:e.message}),Object(g.jsx)("div",{className:"message-user",children:e.userName})]},e.time)})),Object(g.jsx)("div",{ref:E})]}),Object(g.jsxs)("form",{onSubmit:function(e){console.log("e",e),e.preventDefault();var t={message:I,userName:b.userName,time:Date.now()};i.emit("newMessage",t),s((function(e){return[].concat(Object(h.a)(e),[t])})),k(Object(l.a)(Object(l.a)({},y),{},{message:""}))},className:"chat-form",children:[Object(g.jsxs)("label",{htmlFor:"message",className:"message-input",children:["Escribe el mensaje",Object(g.jsx)("input",{type:"text",name:"message",id:"message",onChange:S,value:I})]}),Object(g.jsx)("button",{type:"submit",children:"Enviar"})]})]})},N=function(){var e=Object(u.g)().idChat;return console.log("params",e),Object(g.jsx)("div",{children:Object(g.jsx)(p,{})})},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O.login:return Object(l.a)(Object(l.a)({},t.payload),{},{logged:!0});case O.logout:return Object(l.a)(Object(l.a)({},t.payload),{},{logged:!1});default:return e}},y=function(){return JSON.parse(localStorage.getItem("userChat"))||{logged:!1}};var S=function(){var e=Object(n.useReducer)(C,{},y),t=Object(r.a)(e,2),c=t[0],s=t[1];return Object(n.useEffect)((function(){localStorage.setItem("userChat",JSON.stringify(c))}),[c]),Object(g.jsx)(j.Provider,{value:{user:c,dispatch:s},children:Object(g.jsx)(i.a,{children:Object(g.jsxs)(u.c,{children:[Object(g.jsx)(u.a,{path:"/chat/:idChat",children:Object(g.jsx)(N,{})}),Object(g.jsx)(u.a,{path:"/",children:Object(g.jsx)(m,{})})]})})})},k=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,97)).then((function(t){var c=t.getCLS,n=t.getFID,s=t.getFCP,a=t.getLCP,o=t.getTTFB;c(e),n(e),s(e),a(e),o(e)}))};o.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(S,{})}),document.getElementById("root")),k()}},[[96,1,2]]]);
//# sourceMappingURL=main.031930cd.chunk.js.map